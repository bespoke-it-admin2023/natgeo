(self.webpackChunknatgeo=self.webpackChunknatgeo||[]).push([[4257],{84257:(e,t,a)=>{var n=a(85893);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}a(67294);var o=a(45697),s=a(94184),i=a(3896),c=a(21800),d=a(50239),l=a(84967),h=a(19495),u=a(23493),m=a(11227)("safeframe:main"),f=a(44719).SAFEFRAME_CALLBACK,g=d.first,p=d.isFunc,v=d.emptyObj,b=d.FALSE,y=d.TRUE,w=d.callSafe,S=l.attr,M=l.docScroll,A="scroll",E="resize",k="orientationchange",R=0;a(46869);var C=i({port:null,disposers:null,div:null,events:null,displayName:"SafeFrame",getInitialState:function(){var e=this||v,t=e.props||v,a=++R,n=e.buildName(a),r=t.src,o=t.mode,s=h.loc(),i="",c="";return r&&(i=h(r).toHostString(!0,!0)),s&&(c=s.toHostString(!0,!0)),{id:a,name:n,referrer:c,frameOrigin:i,mode:o,mounted:b}},componentDidMount:function(){var e=this||{},t=e.props||v,a=e.state||v,n=l.view(),r=e.getFrameOrigin();a.referrer!==r&&!1!==t.shouldMount&&(e.events={},e.disposers={},m("Referrer check successful."),m("Waiting for handshake from frame origin..."),l.attach(n,"message",e.onHandshake),e.setState({mounted:y}))},componentDidUpdate:function(e,t){var a=this||v,n=a.state||v,r=a.props||v,o=n.mounted,s=r.mode,i=a.getMode();return a.port&&s!==e.mode&&s!==i?(m("Mode changed via props from %s to %s.",i,s),void a.setState({mode:s},(function(){a.goToMode(s),a.postMessage("MODE",{mode:s})}))):o&&!1===t.mounted?(m("Successfully mounted frame and initialized in %s mode.",i),void a.goToMode(i)):void 0},componentWillUnmount:function(){var e,t=this||v,a=t.events||v,n=t.disposers||v,o=function(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,s=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw s}}}}(d.keys(a));try{for(o.s();!(e=o.n()).done;){var s=e.value;t.detachEvent(s)}}catch(e){o.e(e)}finally{o.f()}for(var i in n){var c=n[i];if(c)try{c.fn(),delete n[i]}catch(e){}}try{t.events=null,t.disposers=null,t.div=null,t.port=null}catch(e){}},setDOM:function(e){this.div=e},onHandshake:function(e){var t,a,n,r=this||v,o=r.state||v,s=o.referrer||"",i=o.frameOrigin||"",c=o.id,d=e||v,h=d.origin||"",u=d.data||v,f=l.view();h===i&&s===u.referrer&&("HANDSHAKE"===u.message&&u.id===c?(l.detach(f,"message",r.onHandshake),n=r.getFrame(),S(n,"name",null),r.port=t=d.ports[0],t.onmessage=r.onMessage,a=r.getMode(),r.postMessage("HANDSHAKE_ACK",{mode:a}),m("Handshake received, connection established with frame with ID %d.",c)):u.id||m("Unrecognized message from frame origin.",u))},onMessage:function(e){var t=this||v,a=e.data||v,n=a.message||"",r=a.data||v;switch(m("".concat(n," has been received.")),n){case"RESIZE":t.handleResize(r);break;case"SUBSCRIBE":t.handleSubscribe(r);break;case"UNSUBSCRIBE":t.handleUnsubscribe(r);break;case"COMMAND":t.handleCommand(r);break;case"READY":t.handleReadyCallback();break;default:m('Unrecognized message cannot be processed: "%s".',n)}},postMessage:function(e,t){var a=(this||v).port,n={message:e};t&&(n.data=t);try{a&&a.postMessage(n)}catch(e){}return n},goToMode:function(e){var t=this||v,a=t.props||v,n=t.getFrame(),r=t.div,o=a.aspectRatio,s=a.width,i=a.height;if(n&&r)switch(e){case"resize-to-content":l.css(n,"width:100%;height:100%"),l.css(r,"");break;case"aspect-ratio":try{l.css(n,"position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;"),l.css(r,"padding-top: ".concat(100*o,"%"))}catch(e){}break;case"static-size":try{var c="width:".concat(s,";height:").concat(i);l.css(n,c),l.css(r,c)}catch(e){}}},handleSubscribe:function(e){var t=this||v,a=e.event,n=e.throttle||0,r=t.events||{},o=r[a];if(a)return o?o.count+=1:r[a]=o={count:1,throttle:n},1===o.count?(m('Attaching new event "%s" with throttle of %dms.',a,n),void t.attachEvent(a,n)):n<o.throttle?(m('Lowering throttle of "%s" to %dms from %dms.',a,n,o.throttle),t.detachEvent(a),void t.attachEvent(a,n)):void 0},handleUnsubscribe:function(e){var t=this||v,a=(t.events||{})[e];a&&(a.count-=1,a.count<=0&&t.detachEvent(e))},handleResize:function(e){var t,a=this||v,n=(e||v).height,r=a.div,o=a.getFrame();if(r&&o)try{t="width: 100%;height: ".concat(n,"px;"),l.css(r,t),l.css(o,t)}catch(e){}},handleCommand:function(e){var t,a=this||v,n=(a.props||v).commands||v,r=e||v,o=r.messageId,s=r.commandName,i=r.params,c=n[s];if(m('Handling command "%s".',s),c&&p(c)){try{t=c(i)}catch(e){return}o&&Promise.resolve(t).then((function(e){m('Send back ack to command "%s".',s),a.postMessage("COMMAND_ACK",{messageId:o,params:e})}))}},handleReadyCallback:function(){var e=((this||v).props||v).onReady||null;e&&w(e)},attachEvent:function(e,t){var a,n=this||v,r="attach_".concat(e),o=(n.props||v).events||v,s=n.disposers||{},i=n[r],c=o[e];if(a=function(a){n.postMessage("EVENT",{name:e,throttle:t,params:a})},t&&t>0&&(a=u(a,t)),!p(i)||s[r])if(!p(c)||s[e]);else try{s[e]={fn:c(a),throttle:t}}catch(e){}else s[e]={fn:i(a),throttle:t}},detachEvent:function(e){var t=(this||v).disposers||{},a=t[e];if(a)try{a.fn(),delete t[e]}catch(e){}},attach_scroll:function(e){var t=this||v,a=l.view();function n(){var a=t.getFrame(),n=M(a),r=l.rect(a);e(c({},r,n))}return l.attach(a,A,n),function(){l.detach(a,A,n)}},attach_resize:function(e){var t=l.winRect,a=l.view();function n(){var a=t(),n={};n.w=a.w,n.h=a.h,e(n)}return l.attach(a,E,n),l.attach(a,k,n),function(){l.detach(a,E,n),l.detach(a,k,n)}},buildName:function(e){var t,a=(this||v).props||v,n=a.content||v,r=a.flags||v,o=c({},n),s="";o.html||(o.html=""),t="<script>".concat(f," && ").concat(f,"();<\/script>"),o.html=t+o.html;try{d.empty(r)||(o.flags=r,r.escapeHTML&&(o.html=d.es(o.html))),o.id=e,s=btoa(JSON.stringify(o))}catch(e){}return s},getFrame:function(){var e=(this||v).div;return e?g(l.tags("iframe",e)):null},getMode:function(){return((this||v).state||v).mode},getFrameOrigin:function(){return((this||v).state||v).frameOrigin||""},render:function(){var e=this||v,t=e.props||v,a=e.state||v,r=t.ariaLabel,o=a.mounted,i=a.name,c=e.setDOM,d=s("SafeFrame",t.className),l=void 0,h=t.lazy||"lazy"===t.loading?"lazy":"eager";if(o){var u=t.src,m=a.id,f=!1!==t.allowFullScreen,g=t.sandbox;l={__html:"<iframe ".concat(m?'id="'.concat(m,'"'):"",' name="').concat(i,'" src="').concat(u,'" scrolling="no" ').concat(f?"allowFullscreen":""," ").concat(g?'sandbox="'.concat(g,'"'):"",' loading="').concat(h,'" style="width:100%;height:100%;" allowtransparency frameborder=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 referrerpolicy="origin"></iframe>')}}return n.jsx("div",{ref:c,"aria-label":r,className:d,dangerouslySetInnerHTML:l})}});C.defaultProps={mode:"resize-to-content",aspectRatio:9/16,width:"100%",height:"100%"},C.propTypes={mode:o.oneOf(["resize-to-content","aspect-ratio","static-size"]),aspectRatio:o.number,width:o.string,height:o.string,commands:o.object,events:o.object,src:o.string,id:o.string,content:o.shape({html:o.string.isRequired,frameID:o.string.isRequired,meta:o.shape({selector:o.string})}),flags:o.shape({escapeHTML:o.bool}),ariaLabel:o.string,className:o.string},e.exports=C},44719:(e,t)=>{t.SAFEFRAME_CALLBACK="window.__callbackSafeframe"},46869:(e,t,a)=>{"use strict";a.r(t)}}]);